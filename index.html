<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>JUST COM ‚Äî ‡πÅ‡∏Ñ‡∏ï‡∏ï‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>
<meta name="description" content="‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ JUST COM ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÅ‡∏¢‡∏Å‡∏´‡∏°‡∏ß‡∏î ‡∏õ‡πâ‡∏≤‡∏¢‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡πÅ‡∏ä‡∏ó‡πÄ‡∏û‡∏à">
<!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå Prompt -->
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#0f1114;--card:#151a1f;--muted:#93a1b3;--line:#222a33;--white:#eaf0f7;--radius:16px;--gap:16px;--maxw:1200px;}
*{box-sizing:border-box}html,body{
  margin:0;
  font-family:'Prompt', ui-sans-serif, system-ui, 'Segoe UI', Roboto, 'Noto Sans Thai', sans-serif;
  background:var(--bg);
  color:var(--white);
}
select {
  background-color: #ffffff;  /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ä‡πà‡∏≠‡∏á select */
  color: #000000;             /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
  border: 1px solid #ccc;     /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö */
  padding: 8px;
  border-radius: 6px;
}
select option {
  background-color: #ffffff;  /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≠‡∏ô dropdown */
  color: #000000;             /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
}
a{color:inherit;text-decoration:none}header{position:sticky;top:0;z-index:10;background:rgba(15,17,20,.75);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid var(--line)}
.wrap{max-width:var(--maxw);margin:0 auto;padding:10px 16px}.row{display:flex;gap:var(--gap);flex-wrap:wrap;align-items:center}.grow{flex:1}.logo{height:36px;width:auto}.sub{opacity:.8;font-size:.9rem}
input,select{width:100%;padding:10px 12px;background:#0d1013;border:1px solid var(--line);border-radius:12px;color:var(--white)}select option{color:#0d1013}
.banner{width:100%;height:auto;border-bottom:1px solid var(--line);display:block}.notice{max-width:var(--maxw);margin:12px auto 0;padding:0 16px;color:var(--muted)}
.notice .chip{display:inline-flex;align-items:center;gap:8px;background:#0d1013;border:1px solid var(--line);border-radius:999px;padding:8px 12px;margin-right:8px;}
.grid{max-width:var(--maxw);margin:18px auto 80px;padding:0 16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px}
.card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column;cursor:pointer;position:relative;transition:transform .08s ease, box-shadow .08s ease}
.card:hover{transform:translateY(-2px);box-shadow:0 10px 26px rgba(0,0,0,.25)}.thumb{background:#0b0e11;aspect-ratio:16/10;object-fit:cover;width:100%;display:block}
.ct{padding:14px;display:flex;flex-direction:column;gap:10px}.title{font-weight:800}.muted{opacity:.8;color:var(--muted);font-size:.92rem}.price{font-weight:900}
.badges{display:flex;flex-wrap:wrap;gap:6px}.badge{background:#0d1013;border:1px solid var(--line);border-radius:999px;padding:4px 8px;font-size:.8rem}
.buybtn{display:inline-flex;align-items:center;gap:8px;background:#fff;color:#111;border:1px solid #111;padding:10px 12px;border-radius:10px;font-weight:900}
.buybtn:hover{background:#f3f3f3}.buybtn svg{width:16px;height:16px}
.ribbon{position:absolute;top:12px;left:-36px;transform:rotate(-20deg);background:#b91c1c;color:#fff;padding:6px 56px;border:1px solid #ef4444;font-weight:900;box-shadow:0 6px 16px rgba(0,0,0,.4)}
.newtag{position:absolute;top:12px;right:12px;background:#059669;color:#fff;padding:6px 10px;border-radius:10px;border:1px solid #10b981;font-weight:900}
.empty{opacity:.7;text-align:center}
.lightbox{position:fixed;inset:0;background:rgba(0,0,0,.65);display:none;align-items:center;justify-content:center;z-index:100}.lightbox.open{display:flex}
.lb{max-width:min(96vw,1180px);max-height:92vh;background:#0b0e11;border:1px solid var(--line);border-radius:16px;overflow:hidden;color:var(--white)}
.lb-head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--line)}
.lb-body{display:grid;grid-template-columns:1.25fr .75fr;gap:14px;padding:14px}.lb-main{height:min(64vh,720px);background:#000;display:flex;align-items:center;justify-content:center;border-radius:10px;overflow:hidden}
.lb-main img{max-width:100%;max-height:100%;object-fit:contain}.lb-thumbs{display:grid;grid-template-columns:repeat(auto-fill,minmax(82px,1fr));gap:8px}
.lb-thumbs img{width:100%;height:70px;object-fit:cover;border:2px solid var(--line);border-radius:8px;cursor:pointer}.xbtn{background:#0d1013;color:var(--white);border:1px solid var(--line);border-radius:999px;padding:6px 10px;cursor:pointer}
footer.f{max-width:var(--maxw);margin:24px auto 60px;color:var(--muted);padding:0 16px}
</style>
</head>
<body>
<img class="banner" src="images/banner.png" alt="Banner">
<header>
  <div class="wrap row">
    <img class="logo" src="images/logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≤‡∏ô">
    <div class="grow">
      <div style="font-weight:900">JUST COM</div>
      <div class="sub">‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏°‡∏∑‡∏≠‡∏´‡∏ô‡∏∂‡πà‡∏á-‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á ‚Ä¢ ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏°‡∏ß‡∏î: <span id="currentCat">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span></div>
    </div>
    <div style="min-width:240px"><input id="q" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: ‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå/‡∏£‡∏∏‡πà‡∏ô/..."></div>
    <div style="min-width:160px">
      <select id="cat">
        <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option><option>‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠ (GPU)</option><option>‡∏ã‡∏µ‡∏û‡∏µ‡∏¢‡∏π (CPU)</option><option>‡πÄ‡∏°‡∏ô‡∏ö‡∏≠‡∏£‡πå‡∏î (Mainboard)</option><option>‡πÅ‡∏£‡∏° (RAM)</option>
        <option>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥ (SSD/HDD)</option><option>‡∏û‡∏≤‡∏ß‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ã‡∏±‡∏û‡∏û‡∏•‡∏≤‡∏¢ (PSU)</option><option>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô/</option><option>‡πÄ‡∏ã‡πá‡∏ó‡∏£‡∏ß‡∏°/‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
      </select>
    </div>
    <div style="min-width:160px">
      <select id="status">
        <option value="">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option><option value="active">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢</option><option value="hidden">‡∏ã‡πà‡∏≠‡∏ô</option><option value="sold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</option>
      </select>
    </div>
  </div>
</header>
<div class="notice"><span class="chip">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span><span class="chip">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î</span></div>
<section class="grid" id="grid"></section>
<div id="empty" class="empty" style="display:none">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</div>
<footer class="f">¬© Copyright 2025 All Rights Reserved By Just Com.</footer>
<div id="lightbox" class="lightbox" role="dialog" aria-modal="true">
  <div class="lb">
    <div class="lb-head"><div id="lb-title" style="font-weight:900"></div><button id="lb-close" class="xbtn">‡∏õ‡∏¥‡∏î</button></div>
    <div class="lb-body">
      <div><div class="lb-main"><img id="lb-mainimg" alt=""></div><div id="lb-thumbs" class="lb-thumbs" style="margin-top:10px"></div></div>
      <div><div id="lb-spec" class="sub"></div><div id="lb-desc" style="margin-top:10px;white-space:pre-wrap"></div></div>
    </div>
  </div>
</div>
<script>

// üîß Robust CSV loader: try multiple candidate paths
const CSV_CANDIDATES = [
  "./justcom_inventory.csv",
  "./data/justcom_inventory.csv",
  location.pathname.replace(/\/[^\/]*$/, "/justcom_inventory.csv"),
  "/JUSTCOM2/justcom_inventory.csv"
];

async function fetchFirst(paths){
  const errors = [];
  for (const p of paths){
    try {
      const url = p + (p.includes("?") ? "&" : "?") + "v=" + Date.now();
      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) { errors.push(p + " -> HTTP " + res.status); continue; }
      const text = await res.text();
      if (!text || !text.trim()) { errors.push(p + " -> empty"); continue; }
      return { text, used: p, errors };
    } catch (e){
      errors.append(p + " -> " + (e && e.message || e));
    }
  }
  throw new Error("CSV not found. Tried: \n" + errors.join("\n"));
}
const CONFIG={mode:"csv",csvPath:"./justcom_inventory.csv",gsheetCsvUrl:"",defaultOrderTarget:"facebook",facebookPageUrl:"https://m.me/justcomth",lineUrl:"https://line.me/R/ti/p/~your_line_id"};
function csvToArray(str,delim=","){const rows=str.split("\n").filter(x=>x.trim().length);if(!rows.length)return[];const headers=rows.shift().split(delim).map(h=>h.trim());return rows.map(row=>{const cols=[];let cur="",inQ=false;for(let i=0;i<row.length;i++){const c=row[i];if(c=='"'){inQ=!inQ;}else if(c===delim && !inQ){cols.push(cur);cur="";}else{cur+=c;}}cols.push(cur);const obj={};headers.forEach((h,i)=>obj[h]=(cols[i]??"").trim());return obj;});}
function fmt(n){try{return Number(n).toLocaleString('th-TH');}catch(e){return n;}}
function listify(s){return (s||"").split(",").map(x=>x.trim()).filter(Boolean);}
function parseDate(s){if(!s) return 0;const t=s.trim().replace(" ","T");const d=new Date(t);return isNaN(d.getTime())?0:d.getTime();}
function updateCurrentCat(){const cur=document.getElementById("cat").value||"";document.getElementById("currentCat").textContent=cur||"‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";}
function pickBuyLink(item) {
  // ‚úÖ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏û‡∏à‡∏´‡∏•‡∏±‡∏Å JUST COM
  const PAGE_URL = "https://www.facebook.com/share/1B8mNcdPZb/?mibextid=wwXIfr";

  // ‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å CSV (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á 100%)
  const dest = (
    item["‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà (facebook|line|custom_url)"] ||
    item["‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà"] ||
    CONFIG.defaultOrderTarget
  ).toLowerCase();

  // ‚úÖ ‡∏î‡∏∂‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å CSV
  const fb = item["‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏û‡∏™‡∏ï‡πå Facebook (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"] || PAGE_URL;
  const custom = item["‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å custom_url ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà)"] || "";

  // ‚úÖ ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå
  if (dest === "facebook") return fb;
  if (dest === "line") return CONFIG.lineUrl;
  if (dest === "custom_url") return custom || PAGE_URL;

  // ‚úÖ fallback ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢
  return PAGE_URL;
}
function isNewItem(item){const tags=(item["‡πÅ‡∏ó‡πá‡∏Å (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ,)"]||"").toLowerCase();if(tags.includes("new"))return true;const d=item["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á (YYYY-MM-DD)"]||"";if(!/^\d{4}-\d{2}-\d{2}$/.test(d))return false;const now=new Date(),dt=new Date(d+"T00:00:00");const diff=(now-dt)/86400000;return diff<=14;}
const lb={root:null,main:null,thumbs:null,title:null,spec:null,desc:null,open(item){const imgs=[item["‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏Å"],...(item["‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ,)"]||"").split(",").map(s=>s.trim()).filter(Boolean)].filter(Boolean);this.title.textContent=item["‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"]||item["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"]||item["SKU"]||"";this.main.src=imgs[0]||"";this.thumbs.innerHTML="";imgs.forEach((u,i)=>{const im=document.createElement("img");im.src=u;im.alt="img"+i;im.addEventListener("click",()=>this.main.src=u);this.thumbs.appendChild(im);});this.spec.innerHTML=[item["‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå"]?`<div><b>‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå:</b> ${item["‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå"]}</div>`:"",item["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"]?`<div><b>‡∏£‡∏∏‡πà‡∏ô:</b> ${item["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"]}</div>`:"",item["‡∏ä‡∏¥‡∏õ/‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡πÄ‡∏ä‡πà‡∏ô RTX 3060 Ti / RX 6700 XT)"]?`<div><b>‡∏ä‡∏¥‡∏õ/‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå:</b> ${item["‡∏ä‡∏¥‡∏õ/‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡πÄ‡∏ä‡πà‡∏ô RTX 3060 Ti / RX 6700 XT)"]}</div>`:"",item["‡∏™‡πÄ‡∏õ‡∏Å‡∏¢‡πà‡∏≠‡∏¢ (VRAM/‡∏Ç‡∏ô‡∏≤‡∏î/‡∏™‡∏µ ‡∏Ø‡∏•‡∏Ø)"]?`<div><b>‡∏™‡πÄ‡∏õ‡∏Å:</b> ${item["‡∏™‡πÄ‡∏õ‡∏Å‡∏¢‡πà‡∏≠‡∏¢ (VRAM/‡∏Ç‡∏ô‡∏≤‡∏î/‡∏™‡∏µ ‡∏Ø‡∏•‡∏Ø)"]}</div>`:"",item["‡∏™‡∏†‡∏≤‡∏û"]?`<div><b>‡∏™‡∏†‡∏≤‡∏û:</b> ${item["‡∏™‡∏†‡∏≤‡∏û"]}</div>`:"",item["‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô (‡∏ß‡∏±‡∏ô)"]?`<div><b>‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô:</b> ${item["‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô (‡∏ß‡∏±‡∏ô)"]} ‡∏ß‡∏±‡∏ô</div>`:"",item["‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)"]?`<div><b>‡∏£‡∏≤‡∏Ñ‡∏≤:</b> ${fmt(item["‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)"])} ‡∏ø</div>`:""] .filter(Boolean).join("");this.desc.textContent=item["‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"]||"";this.root.classList.add("open");},close(){this.root.classList.remove("open");this.main.src="";this.thumbs.innerHTML="";this.spec.innerHTML="";this.desc.textContent="";}};
function initLightbox(){lb.root=document.getElementById("lightbox");lb.main=document.getElementById("lb-mainimg");lb.thumbs=document.getElementById("lb-thumbs");lb.title=document.getElementById("lb-title");lb.spec=document.getElementById("lb-spec");lb.desc=document.getElementById("lb-desc");document.getElementById("lb-close").addEventListener("click",()=>lb.close());lb.root.addEventListener("click",(e)=>{if(e.target===lb.root)lb.close();});}
function render(items){const grid=document.getElementById("grid");const empty=document.getElementById("empty");grid.innerHTML="";if(!items.length){empty.style.display="block";return;}empty.style.display="none";items.forEach(item=>{if((item["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (active|hidden|sold)"]||"").toLowerCase()==="hidden")return;const imgs=[item["‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏Å"],...listify(item["‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ,)"])].filter(Boolean);const cover=imgs[0]||"";const price=item["‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)"]?fmt(item["‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)"])+" ‡∏ö‡∏≤‡∏ó":"‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤";const buy=pickBuyLink(item);const status=(item["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (active|hidden|sold)"]||"active").toLowerCase();const badgeList=[];if(item["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠"])badgeList.push("‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ "+item["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠"]);if(item["‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô (‡∏ß‡∏±‡∏ô)"])badgeList.push("‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô "+item["‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô (‡∏ß‡∏±‡∏ô)"]+" ‡∏ß‡∏±‡∏ô");if(item["‡∏ä‡∏¥‡∏õ/‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡πÄ‡∏ä‡πà‡∏ô RTX 3060 Ti / RX 6700 XT)"])badgeList.push(item["‡∏ä‡∏¥‡∏õ/‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡πÄ‡∏ä‡πà‡∏ô RTX 3060 Ti / RX 6700 XT)"]);const card=document.createElement("div");card.className="card";card.innerHTML=`${cover?`<img class="thumb" src="${cover}" alt="">`:`<div class="thumb"></div>`}${status==="sold"?`<div class="ribbon">SOLD OUT</div>`:""}${isNewItem(item)?`<div class="newtag">NEW</div>`:""}<div class="ct"><div class="title">${item["‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"]||item["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"]||item["SKU"]||"‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠"}</div><div class="muted">${item["‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå"]||""} ${item["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"]?("‚Ä¢ "+item["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"]):""}</div><div class="price">${price}</div><div class="badges">${badgeList.map(b=>`<span class="badge">${b}</span>`).join(" ")}</div><div class="row" style="gap:10px"><a class="buybtn" href="${buy}" target="_blank" rel="noopener" onclick="event.stopPropagation()">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg></a></div></div>`;card.addEventListener("click",()=>lb.open(item));grid.appendChild(card);});}
async function boot(){initLightbox();const q=document.getElementById("q");const cat=document.getElementById("cat");const status=document.getElementById("status");
async function loadData(){
  try{
    // try multiple csv locations
    const { text, used, errors } = await fetchFirst(CSV_CANDIDATES);
    window.__CSV_USED__ = used;
    console.log("‚úÖ Loaded CSV from:", used);
    const items = csvToArray(text);
    return items;
  }catch(err){
    console.error("‚ùå CSV load failed:", err);
    // show a friendly message
    const empty = document.getElementById("empty");
    empty.style.display = "block";
    empty.textContent = "‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏∑‡πà‡∏≠/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏ü‡∏•‡πå justcom_inventory.csv (‡∏î‡∏π‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ã‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)";
    return [];
  }
}
function apply(list){const qv=q.value.trim();const cv=cat.value.trim();const sv=status.value.trim();let items=[...list];if(qv)items=items.filter(it=>{const hay=[it["‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"],it["‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå"],it["‡∏£‡∏∏‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏¢"],it["‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"],it["‡πÅ‡∏ó‡πá‡∏Å (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ,)"],it["SKU"]].join(" ").toLowerCase();return hay.includes(qv.toLowerCase());});if(cv)items=items.filter(it=>(it["‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"]||"")===cv);if(sv)items=items.filter(it=>(it["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (active|hidden|sold)"]||"").toLowerCase()===sv);items.sort((a,b)=>{const sa=((a["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (active|hidden|sold)"]||"").toLowerCase()==="sold")?1:0;const sb=((b["‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (active|hidden|sold)"]||"").toLowerCase()==="sold")?1:0;if(sa!==sb)return sa-sb;const da=parseDate(a["‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (YYYY-MM-DD HH:MM)"])||parseDate(a["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á (YYYY-MM-DD)"]);const db=parseDate(b["‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (YYYY-MM-DD HH:MM)"])||parseDate(b["‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á (YYYY-MM-DD)"]);if(da!==db)return db-da;const pa=Number(a["‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)"]||0);const pb=Number(b["‡∏£‡∏≤‡∏Ñ‡∏≤ (THB)"]||0);return pb-pa;});render(items);}const data=await loadData();apply(data);q.addEventListener("input",()=>apply(data));cat.addEventListener("change",()=>{updateCurrentCat();apply(data);});status.addEventListener("change",()=>apply(data));updateCurrentCat();}
boot();
</script>
</body>
</html>
